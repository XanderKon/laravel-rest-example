# Пример crud api

## Требования к локальной разработке

- Необходимо наличие установленного php версии >= 8.1 (на более ранних версиях, скорее всего, будут
проблемы с установкой зависимостей), со всеми базовыми расширениями;
- Необходим запущенный сервер с БД PostgreSQL (тесты проводились с использованием актуальной версии 15.4).
  Также необходимо проследить, что будет создана необходимая БД, которая указывается в файлике .env (см. ниже);
- Необходим установленный менеджер пакетов composer (https://getcomposer.org/doc/00-intro.md).

Рекомендуется также рассмотреть возможность запуска в докер-окружении, что избавит от необходимости
устанавливать необходимое ПО и даст гибкость в настройках и различного рода экспериментах.

## Для запуска

- Копируем конфиг

  `cp .env.example .env`

  и редактируем его согласно потребностям.

  Наиболее вероятно, что придётся изменить параметры подключения к локальной БД (опции с префиксом **DB_**)

- Устанавливаем зависимости

  `composer install`

- Запускаем миграции и сиды (в данном примере сидирование базы не используется)

  `php artisan migrate`

  `php artisan db:seed`

- Запускаем локальный веб-сервер

  `php artisan serve`

Готово! Результатом выполнения всех команд выше должно быть работающее веб-приложение, доступное по адресу http://127.0.0.1:8000/.

Доступные методы:

```
GET|HEAD   api/v1/news ................ news.get › NewsController@get
POST       api/v1/news ................ news.create › NewsController@create
DELETE     api/v1/news ................ news.delete › NewsController@delete
PATCH      api/v1/news ................ news.update › NewsController@update
GET|HEAD   api/v1/news/search ......... news.search › NewsController@search
```

## Тесты

- Запускаем тесты

  `vendor/bin/phpunit`

  Важный момент! При запуске тестов будет использоваться подключение к БД, что может повлечь за собой удаление всех
  данных, добавленных туда до запуска тестов. При необходимости разграничить использование БД можно через дополнительную
  конфигурацию окружения, используя **.env.testing**, где указать подключение к тестовой БД (обычно то же подключение, но
  другая схема).

## Дополнительная информация

  Пару слов об архитектуре проекта, предложенной автором. Можно заметить, что в директории **app/** есть директория **Services**,
  которой нет в изначальном шаблоне, предоставляемым авторами Laravel. В данном конкретном примере вся бизнес-логика нашего
  АПИ хранится именно в директории **app/Services**, хотя в самом базовом примере эту логику можно было бы написать
  непосредственно в контроллере или даже в модели. Это сделано для более "чистой" архитектуры, дабы не смешивать различные
  слои приложения. К тому же, использование отдельного слоя для бизнес-логики, позволяет куда легче осуществлять тестирование
  нашего приложения.

  [FAQ](docs/FAQ.md) 
